@using System.Net.Http
@using System.Net.Http.Json
@using System.Text.Json.Serialization
@using Blog.Core.Entities

@{
    //PostForm component: This component would allow a user to create a new post. It would have a title input field, a WYSIWYG editor, and buttons to save as draft, publish, and close.
}

<div>
    <label for="title">Title:</label>
    <input id="title" @bind-value="@Title" /><br />
    <label for="content">Content:</label>
    <textarea id="content" @bind-Value="@Content" @bind-Value:event="oninput"></textarea><br />
    <button @onclick="SavePost">Save</button>
</div>

@code {
    public string Title { get; set; }
    public string Content { get; set; }
    [Parameter]
    public EventCallback<Post> OnPostCreated { get; set; }

    [Inject]
    private HttpClient HttpClient { get; set; }

    private async Task SavePost()
    {
        var post = new Post
        {
            Title = Title,
            Content = Content,
            UserId = 1
        };
        
        var response = await HttpClient.PostAsJsonAsync("api/Posts", post);
        response.EnsureSuccessStatusCode();
        await OnPostCreated.InvokeAsync(post);

        //todo: add logging
    }
}